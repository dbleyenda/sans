define(["jquery","underscore","backbone","youTubeIFrame","text!templates/home/homeTemplate.html","precook"],function(a,b,c,d,e){var f=c.View.extend({el:"#id_home",featuredSelected:0,featuredTotal:4,loaded:!1,videoIDs:["g0ddeyzl8go","v4Uv2j1rRKU","tbByZdoeo1Y","0_l4kyW9aD0"],timeToStart:[915,34,188,24],player:null,scrolling:!1,videoTimeout:null,events:{"click a.unload":"onUnloadPageClicked","click #id_prev, #id_next":"onNavFeaturedClicked",mousewheel:"onMouseWheel","click #id_sound li":"onToggleSoundClicked"},initialize:function(){b.isUndefined(window.videoVolumeStatus)&&(window.videoVolumeStatus="unMuted"),this.preloadImages("home")},render:function(){var a=b.template(e);return this.$el.append(a({})),"muted"==window.videoVolumeStatus&&this.$el.find("#id_sound li").addClass("muted"),this.loaded||(this.$el.removeClass("loading"),this.loaded=!0),this.loadYouTubePlayer(),this},preloadImages:function(a){var b=this,c=new Precook;c.on("preloader:configLoaded",function(){c.load(a)}),c.on("preloader:completed",function(a){b.loadPage()}),c.setConfig(IMAGES_JSON)},loadPage:function(){a("body").removeClass("white-logo"),this.$el.addClass("featured-0"),a("body").removeClass("loader"),a(".layout section").addClass("loading"),a("body > .grid").removeClass("loading"),a("#id_menu").addClass("hidden"),a("#id_menu").removeClass("opened"),a("body").css("overflow","hidden"),a("body").removeClass("menu-page"),a("body").removeClass("about-page"),a("body").removeClass("projects-page"),a("body").removeClass("detail-page"),a("body").addClass("home-page"),this.render()},loadYouTubePlayer:function(){function b(a){"unMuted"==window.videoVolumeStatus?a.target.unMute():a.target.mute(),a.target.setVolume(0),a.target.playVideo()}function c(b){if(b.data==d.PlayerState.UNSTARTED&&(setTimeout(function(){b.target.setVolume(5)},1e3),setTimeout(function(){b.target.setVolume(10)},2e3),a.$el.find(".video-bg").removeClass("loaded"),b.target.seekTo(a.timeToStart[a.featuredSelected])),b.data==d.PlayerState.PLAYING){a.$el.find(".video-bg").addClass("loaded");var c;c=a.featuredSelected+1>=a.featuredTotal?0:a.featuredSelected+1,a.videoTimeout=setTimeout(function(){a.$el.find(".video-bg").removeClass("loaded"),b.target.setVolume(5),setTimeout(function(){b.target.setVolume(0)},1e3),setTimeout(function(){a.changeSlide(c)},550)},9e3)}}var a=this;null!=this.videoTimeout&&clearTimeout(this.videoTimeout),null==this.player?this.player=new d.Player("player",{height:"100%",width:"100%",videoId:this.videoIDs[this.featuredSelected],playerVars:{controls:0,showinfo:0,rel:0,start:this.timeToStart[this.featuredSelected]},events:{onReady:b,onStateChange:c}}):this.player.loadVideoById(this.videoIDs[this.featuredSelected])},onMouseWheel:function(a){if(!this.scrolling&&Math.abs(a.originalEvent.wheelDelta/120)>.1){this.scrolling=!0;var b;b=a.originalEvent.wheelDelta/120>0?this.featuredSelected-1<0?3:this.featuredSelected-1:this.featuredSelected+1>=this.featuredTotal?0:this.featuredSelected+1,this.changeSlide(b);var c=this;setTimeout(function(){c.scrolling=!1},1500)}},onNavFeaturedClicked:function(b){var c=parseInt(this.$el.attr("class").split("-")[1]);a(b.currentTarget).hasClass("prev")?c-1<0?c=3:c--:a(b.currentTarget).hasClass("next")&&(c+1>=this.featuredTotal?c=0:c++),this.changeSlide(c)},changeSlide:function(a){var b=this;b.$el.removeClass("featured-"+b.featuredSelected),b.$el.addClass("featured-"+a),b.featuredSelected=a,setTimeout(function(){b.loadYouTubePlayer()},550)},onToggleSoundClicked:function(b){var c=a(b.currentTarget);this.player&&("unMuted"==window.videoVolumeStatus?(this.player.mute(),window.videoVolumeStatus="muted",c.addClass("muted")):(this.player.unMute(),window.videoVolumeStatus="unMuted",c.removeClass("muted")))},pauseVideo:function(){null!=this.videoTimeout&&(clearTimeout(this.videoTimeout),this.player.pauseVideo())},onUnloadPageClicked:function(b){b.preventDefault(),this.$el.addClass("loading"),this.pauseVideo(),a("body > .grid").addClass("loading"),a("#id_menu").removeClass("hidden"),window.location.href=a(b.currentTarget).attr("href")},destroy:function(){var a=this;setTimeout(function(){a.undelegateEvents(),a.$el.removeData().unbind(),a.remove(),c.View.prototype.remove.call(a)},550)}});return f});